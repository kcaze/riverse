function SfxrParams(){this.setSettings=function(e){for(var t=0;24>t;t++)this[String.fromCharCode(97+t)]=e[t]||0;.01>this.c&&(this.c=.01),e=this.b+this.c+this.e,.18>e&&(e=.18/e,this.b*=e,this.c*=e,this.e*=e)}}function SfxrSynth(){this._params=new SfxrParams;var e,t,a,n,o,r,i,c,s,l,d,h;this.reset=function(){var e=this._params;n=100/(e.f*e.f+.001),o=100/(e.g*e.g+.001),r=1-e.h*e.h*e.h*.01,i=-e.i*e.i*e.i*1e-6,e.a||(d=.5-e.n/2,h=5e-5*-e.o),c=1+e.l*e.l*(0<e.l?-.9:10),s=0,l=1==e.m?0:(1-e.m)*(1-e.m)*2e4+32},this.totalReset=function(){this.reset();var n=this._params;return e=n.b*n.b*1e5,t=n.c*n.c*1e5,a=n.e*n.e*1e5+12,3*((e+t+a)/3|0)},this.synthWave=function(f,u){var _=this._params,p=1!=_.s||_.v,k=_.v*_.v*.1,z=1+3e-4*_.w,m=_.s*_.s*_.s*.1,x=1+1e-4*_.t,g=1!=_.s,v=_.x*_.x,w=_.g,y=_.q||_.r,b=_.r*_.r*_.r*.2,S=_.q*_.q*(0>_.q?-1020:1020),E=_.p?((1-_.p)*(1-_.p)*2e4|0)+32:0,A=_.d,R=_.j/2,T=_.k*_.k*.01,C=_.a,M=e,O=1/e,I=1/t,L=1/a,_=5/(1+_.u*_.u*20)*(.01+m);_>.8&&(_=.8);for(var D,G,P,U,B,_=1-_,q=!1,H=0,N=0,j=0,K=0,Y=0,F=0,W=0,Z=0,X=0,J=0,V=Array(1024),Q=Array(32),$=V.length;$--;)V[$]=0;for($=Q.length;$--;)Q[$]=2*Math.random()-1;for($=0;u>$;$++){if(q)return $;if(E&&++X>=E&&(X=0,this.reset()),l&&++s>=l&&(l=0,n*=c),r+=i,n*=r,n>o&&(n=o,w>0&&(q=!0)),G=n,R>0&&(J+=T,G*=1+Math.sin(J)*R),G|=0,8>G&&(G=8),C||(d+=h,0>d?d=0:d>.5&&(d=.5)),++N>M)switch(N=0,++H){case 1:M=t;break;case 2:M=a}switch(H){case 0:j=N*O;break;case 1:j=1+2*(1-N*I)*A;break;case 2:j=1-N*L;break;case 3:j=0,q=!0}y&&(S+=b,P=0|S,0>P?P=-P:P>1023&&(P=1023)),p&&z&&(k*=z,1e-5>k?k=1e-5:k>.1&&(k=.1)),B=0;for(var et=8;et--;){if(W++,W>=G&&(W%=G,3==C))for(D=Q.length;D--;)Q[D]=2*Math.random()-1;switch(C){case 0:U=d>W/G?.5:-.5;break;case 1:U=1-W/G*2;break;case 2:U=W/G,U=6.28318531*(U>.5?U-1:U),U=1.27323954*U+.405284735*U*U*(0>U?1:-1),U=.225*((0>U?-1:1)*U*U-U)+U;break;case 3:U=Q[Math.abs(32*W/G|0)]}p&&(D=F,m*=x,0>m?m=0:m>.1&&(m=.1),g?(Y+=(U-F)*m,Y*=_):(F=U,Y=0),F+=Y,K+=F-D,U=K*=1-k),y&&(V[Z%1024]=U,U+=V[(Z-P+1024)%1024],Z++),B+=U}B=.125*B*j*v,f[$]=B>=1?32767:-1>=B?-32768:32767*B|0}return u}}function loadJSFXR(e,t){var a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.onload=function(){audio_context.decodeAudioData(a.response,t)},a.send()}function loadSonant(e,t){new sonantx.MusicGenerator(e).createAudioBuffer(t)}function incrementRecord(e,t){localStorage.setItem(e,parseInt(localStorage.getItem(e),10)+t)}function maxRecord(e,t){localStorage.setItem(e,Math.max(parseInt(localStorage.getItem(e),10),t))}function getRecord(e){return parseInt(localStorage.getItem(e),10)}var sonantx;!function(){function e(e){return Math.sin(6.283184*e)}function t(e,t){setTimeout(function(){var a=new Uint8Array(4*e),n=a.length-2,o=function(){for(var e=new Date,r=0;n>=0;)if(a[n]=0,a[n+1]=128,n-=2,r+=1,0===r%1e3&&100<new Date-e)return void setTimeout(o,0);setTimeout(function(){t(a)},0)};setTimeout(o,0)},0)}function a(e,t,a,n,o){var r=a.fx_delay_time*n>>1,i=a.fx_delay_amt/255,c=0,s=function(){for(var a=new Date,n=0;t-r>c;){var l=4*c,d=4*(c+r),h=e[d]+(e[d+1]<<8)+(e[l+2]+(e[l+3]<<8)-32768)*i;if(e[d]=255&h,e[d+1]=h>>8&255,h=e[d+2]+(e[d+3]<<8)+(e[l]+(e[l+1]<<8)-32768)*i,e[d+2]=255&h,e[d+3]=h>>8&255,++c,n+=1,0===n%1e3&&100<new Date-a)return void setTimeout(s,0)}setTimeout(o,0)};setTimeout(s,0)}sonantx={};var n=null,o=[e,function(t){return 0>e(t)?-1:1},function(e){return e%1-.5},function(e){return e=e%1*4,2>e?e-1:3-e}];sonantx.AudioGenerator=function(e){this.mixBuf=e,this.waveSize=e.length/2/2},sonantx.AudioGenerator.prototype.getWave=function(){var e,t,a,n,o,r=this.mixBuf,i=4*this.waveSize;for(e=i-8,t=e-36,n=String.fromCharCode(82,73,70,70,255&e,e>>8&255,e>>16&255,e>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&t,t>>8&255,t>>16&255,t>>24&255),e=0;i>e;){for(a="",t=0;256>t&&i>e;++t,e+=2)o=4*(r[e]+(r[e+1]<<8)-32768),o=-32768>o?-32768:o>32767?32767:o,a+=String.fromCharCode(255&o,o>>8&255);n+=a}return n},sonantx.AudioGenerator.prototype.getAudio=function(){var e=this.getWave(),e=new Audio("data:audio/wav;base64,"+btoa(e));return e.preload="none",e.load(),e},sonantx.AudioGenerator.prototype.getAudioBuffer=function(e){null===n&&(n=new AudioContext);var t=this.mixBuf,a=this.waveSize,o=n.createBuffer(2,this.waveSize,44100),r=o.getChannelData(0),i=o.getChannelData(1),c=0,s=function(){for(var n=new Date,l=0;a>c;){var d=4*(t[4*c]+(t[4*c+1]<<8)-32768),d=-32768>d?-32768:d>32767?32767:d;if(r[c]=d/32768,d=4*(t[4*c+2]+(t[4*c+3]<<8)-32768),d=-32768>d?-32768:d>32767?32767:d,i[c]=d/32768,c+=1,l+=1,0===l%1e3&&100<new Date-n)return void setTimeout(s,0)}setTimeout(function(){e(o)},0)};setTimeout(s,0)},sonantx.SoundGenerator=function(e,t){this.instr=e,this.rowLen=t||5605,this.osc_lfo=o[e.lfo_waveform],this.osc1=o[e.osc1_waveform],this.osc2=o[e.osc2_waveform],this.attack=e.env_attack,this.sustain=e.env_sustain,this.release=e.env_release,this.panFreq=Math.pow(2,e.fx_pan_freq-8)/this.rowLen,this.lfoFreq=Math.pow(2,e.lfo_freq-8)/this.rowLen},sonantx.SoundGenerator.prototype.genSound=function(t,a,n){var o=0,r=0,i=.00390625*Math.pow(1.059463094,t+12*(this.instr.osc1_oct-8)+this.instr.osc1_det-128)*(1+8e-4*this.instr.osc1_detune);t=.00390625*Math.pow(1.059463094,t+12*(this.instr.osc2_oct-8)+this.instr.osc2_det-128)*(1+8e-4*this.instr.osc2_detune);for(var c=this.instr.fx_resonance/255,s=0,l=0,d=this.attack+this.sustain+this.release-1;d>=0;--d){var h=d+n,f=this.osc_lfo(h*this.lfoFreq)*this.instr.lfo_amt/512+.5,u=1;d<this.attack?u=d/this.attack:d>=this.attack+this.sustain&&(u-=(d-this.attack-this.sustain)/this.release);var _=i;this.instr.lfo_osc1_freq&&(_+=f),this.instr.osc1_xenv&&(_=_*u*u);var o=o+_,p=this.osc1(o)*this.instr.osc1_vol,_=t;switch(this.instr.osc2_xenv&&(_=_*u*u),r+=_,p+=this.osc2(r)*this.instr.osc2_vol,this.instr.noise_fader&&(p+=(2*Math.random()-1)*this.instr.noise_fader*u),p*=u/255,_=this.instr.fx_freq,this.instr.lfo_fx_freq&&(_*=f),_=1.5*Math.sin(3.141592*_/44100),s+=_*l,f=c*(p-l)-s,l+=_*f,this.instr.fx_filter){case 1:p=f;break;case 2:p=s;break;case 3:p=l;break;case 4:p=s+f}_=e(h*this.panFreq)*this.instr.fx_pan_amt/512+.5,p=39*p*this.instr.env_master,h*=4,h+3<a.length&&(f=a[h]+(a[h+1]<<8)+p*(1-_),a[h]=255&f,a[h+1]=f>>8&255,f=a[h+2]+(a[h+3]<<8)+p*_,a[h+2]=255&f,a[h+3]=f>>8&255)}},sonantx.SoundGenerator.prototype.getAudioGenerator=function(e,n){var o=this.attack+this.sustain+this.release-1+32*this.rowLen,r=this;t(o,function(t){r.genSound(e,t,0),a(t,o,r.instr,r.rowLen,function(){n(new sonantx.AudioGenerator(t))})})},sonantx.SoundGenerator.prototype.createAudio=function(e,t){this.getAudioGenerator(e,function(e){t(e.getAudio())})},sonantx.SoundGenerator.prototype.createAudioBuffer=function(e,t){this.getAudioGenerator(e,function(e){e.getAudioBuffer(t)})},sonantx.MusicGenerator=function(e){this.song=e,this.waveSize=44100*e.songLen},sonantx.MusicGenerator.prototype.generateTrack=function(e,n,o){var r=this;t(this.waveSize,function(t){var i=r.waveSize,c=4*r.waveSize,s=r.song.rowLen,l=new sonantx.SoundGenerator(e,s),d=e.notes.length,h=0,f=0,u=function(){for(var a=new Date;;){if(f===d){setTimeout(_,0);break}var n=e.notes[f];if(n&&l.genSound(n,t,h),f++,h+=3*s,100<new Date-a){setTimeout(u,0);break}}},_=function(){a(t,i,e,s,k)},p=0,k=function(){for(var e=new Date,a=0;c>p;){var r=n[p]+(n[p+1]<<8)+t[p]+(t[p+1]<<8)-32768;if(n[p]=255&r,n[p+1]=r>>8&255,p+=2,a+=1,0===a%1e3&&100<new Date-e)return void setTimeout(k,0)}setTimeout(o,0)};setTimeout(u,0)})},sonantx.MusicGenerator.prototype.getAudioGenerator=function(e){var a=this;t(this.waveSize,function(t){var n=0,o=function(){n<a.song.songData.length?(n+=1,a.generateTrack(a.song.songData[n-1],t,o)):e(new sonantx.AudioGenerator(t))};o()})},sonantx.MusicGenerator.prototype.createAudio=function(e){this.getAudioGenerator(function(t){e(t.getAudio())})},sonantx.MusicGenerator.prototype.createAudioBuffer=function(e){this.getAudioGenerator(function(t){t.getAudioBuffer(e)})}}();var synth=new SfxrSynth;window.jsfxr=function(e){synth._params.setSettings(e);var t=synth.totalReset();e=new Uint8Array(4*((t+1)/2|0)+44);var t=2*synth.synthWave(new Uint16Array(e.buffer,44),t),a=new Uint32Array(e.buffer,0,44);a[0]=1179011410,a[1]=t+36,a[2]=1163280727,a[3]=544501094,a[4]=16,a[5]=65537,a[6]=44100,a[7]=88200,a[8]=1048578,a[9]=1635017060,a[10]=t;for(var t=t+44,a=0,n="data:audio/wav;base64,";t>a;a+=3)var o=e[a]<<16|e[a+1]<<8|e[a+2],n=n+("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[o>>18]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[o>>12&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[o>>6&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[63&o]);return n};for(var kz={loadResources:function(e){var t=[];return kz.resources={},t.push(kz.loadImages(e.images)),t.push(kz.loadSounds(e.sounds)),Promise.all(t).then(function(){return kz.resources})},loadImages:function(e){var t,a={},n=[];for(t in e)n.push(new Promise(function(n){var o=t,r=new Image;r.addEventListener("load",function(){var t,i=document.createElement("canvas"),c=i.getContext("2d");t=e[o].crop?e[o].crop:{x:0,y:0,w:r.width,h:r.height},i.width=t.w,i.height=t.h,c.drawImage(r,t.x,t.y,t.w,t.h,0,0,t.w,t.h),a[o]=i,n()}),r.src=e[t].data}));return Promise.all(n).then(function(){return kz.resources.images=a,kz.resources.images})},loadSounds:function(e){kz.audio_context=new AudioContext;var t,a={},n=[];for(t in e)n.push(new Promise(function(n){var o=t;e[t].loader(e[t].data,function(e){console.log("Loaded ",o),a[o]={play:function(e){e=void 0==typeof e?!1:e;var t=kz.audio_context.createBufferSource();return t.loop=e,t.buffer=this.buffer,t.connect(kz.audio_context.destination),t.start(0),t},buffer:e},n()})}));return Promise.all(n).then(function(){return kz.resources.sounds=a,kz.resources.sounds})},KEYS:{ENTER:13,ESCAPE:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,Z:90},keys_status:{}},ii=0;256>ii;ii++)kz.keys_status[ii]=0;kz.TOUCHES={},kz.tween=function(e){var t=performance.now(),a=e.object[e.property],n=e.value,o=e.duration?e.duration:Math.abs(n-a)/e.rate;return new Promise(function(r){function i(){var c=(performance.now()-t)/o;c>=1?(e.object[e.property]=n,r()):(e.object[e.property]=c*n+(1-c)*a,window.requestAnimationFrame(i))}window.requestAnimationFrame(i)})},kz.events=[],kz.sendEvent=function(e){kz.events.push(e)},kz.processEvents=function(){for(var e=0;e<kz.events.length;e++)for(var t in kz.entities)kz.entities[t].listen(kz.events[e]);kz.events=[]},kz.__entity_id__=0,kz.Entity=function(e){for(name in e)e.hasOwnProperty(name)&&(this[name]=e[name]);this.__entity_id__=kz.__entity_id__,kz.entities[this.__entity_id__]=this,kz.__entity_id__++},kz.Entity.prototype.x=0,kz.Entity.prototype.y=0,kz.Entity.prototype.listen=function(){},kz.Entity.prototype.destroy=function(){delete kz.entities[this.__entity_id__]},kz.Scene=function(){},kz.Scene.prototype.initialize=function(){},kz.Scene.prototype.preUpdate=function(){},kz.Scene.prototype.postUpdate=function(){},kz.Scene.prototype.draw=function(){},kz.Scene.prototype.exit=function(){},kz.initializeCanvas=function(e){kz.canvas=document.getElementById(e),kz.context=kz.canvas.getContext("2d"),kz.context.clearAll=function(){kz.context.clearRect(0,0,kz.canvas.width,kz.canvas.height)}},kz.initialize=function(e){kz.initializeCanvas(e),document.addEventListener("keydown",function(e){e.preventDefault(),0==kz.keys_status[e.which]?(kz.keys_status[e.which]=1,e.kztype="keypress"):e.kztype="keyheld",kz.events.push(e)}),document.addEventListener("keyup",function(e){e.preventDefault(),e.kztype="keyup",kz.keys_status[e.which]=0,kz.events.push(e)}),document.addEventListener("touchstart",function(e){e.preventDefault();for(var t=0;t<e.touches.length;t++){var a=e.touches[t];kz.TOUCHES[a.identifier]||(kz.TOUCHES[a.identifier]={initial:a,current:a})}console.log("touchstart:",e,JSON.stringify(kz.TOUCHES))}),document.addEventListener("touchmove",function(e){e.preventDefault();for(var t=0;t<e.touches.length;t++){var a=e.touches[t];kz.TOUCHES[a.identifier]&&(kz.TOUCHES[a.identifier].current=a)}console.log("touchmove:",e,JSON.stringify(kz.TOUCHES))}),document.addEventListener("touchend",function(e){e.preventDefault();for(var t in kz.TOUCHES){for(var a=!1,n=0;n<e.touches.length;n++)e.touches[n].identifier==t&&(a=!0);if(!a){var a=kz.TOUCHES[t].initial.screenX,n=kz.TOUCHES[t].initial.screenY,o=kz.TOUCHES[t].current.screenX,r=kz.TOUCHES[t].current.screenY;20>Math.abs(a-o)+Math.abs(n-r)?kz.events.push({kztype:"keypress",which:kz.KEYS.Z}):40>Math.abs(n-r)&&a-o>20?kz.events.push({kztype:"keypress",which:kz.KEYS.LEFT}):40>Math.abs(n-r)&&o-a>20&&kz.events.push({kztype:"keypress",which:kz.KEYS.RIGHT}),delete kz.TOUCHES[t]}}console.log("touchend:",e,JSON.stringify(kz.TOUCHES))})};var tickID;kz.tick=function(){kz.scene.preUpdate(kz.performance.now()),kz.scene.draw(kz.performance.now()),kz.scene.postUpdate(kz.performance.now()),tickID=window.requestAnimationFrame(kz.tick)},kz.run=function(e){tickID&&window.cancelAnimationFrame(tickID),kz.scene&&kz.scene.exit(),kz.entities={},kz.scene=e,kz.scene.initialize(),kz.alive=!0,tickID=window.requestAnimationFrame(kz.tick)},kz.performance=Object.create(performance),kz.performance.pauseTime=0,kz.performance.now=function(){return kz.paused?kz.pauseNow:performance.now()-kz.performance.pauseTime},kz.paused=!1,kz.pauseTime=0,kz.pause=function(){kz.pauseNow=kz.performance.now(),kz.pauseTime=performance.now(),kz.paused=!0},kz.resume=function(){kz.performance.pauseTime+=performance.now()-kz.pauseTime,kz.paused=!1};var scene_loading=new kz.Scene;scene_loading.preUpdate=function(){kz.events=[]},scene_loading.draw=function(e){kz.context.clearAll(),kz.context.save(),kz.context.fillStyle="#30403b",kz.context.fillRect(0,0,kz.canvas.width,kz.canvas.height),kz.context.restore(),text=["LOADING","LOADING.","LOADING..","LOADING..."],kz.context.save(),kz.context.textAlign="center",kz.context.textBaseline="center",kz.context.font="18px font",kz.context.fillStyle="rgb(142, 212, 165)",kz.context.lineWidth=2,kz.context.fillText(text[Math.round(e/500)%4],kz.canvas.width/2,kz.canvas.height/2),kz.context.restore()};var scene_main_menu=function(){var e,t=new kz.Scene;return t.initialize=function(){e={press_space_visible:!0,blink:!0,text_alpha:1,fadeAlpha:1,exiting:!1},kz.tween({object:e,property:"fadeAlpha",value:0,duration:100})},t.draw=function(){kz.context.clearAll(),kz.context.save(),kz.context.fillStyle="#30403b",kz.context.fillRect(0,0,kz.canvas.width,kz.canvas.height),kz.context.restore(),kz.context.textAlign="center",kz.context.textBaseline="center",kz.context.font="48px font",kz.context.fillStyle="#8ed4a5",kz.context.fillText("ZODIAC 13",kz.canvas.width/2,125),e.press_space_visible&&(kz.context.save(),kz.context.globalAlpha=e.text_alpha,kz.context.font="24px font",kz.context.fillStyle="white",kz.context.fillText("PRESS   Z",kz.canvas.width/2,250),kz.context.restore()),kz.context.save(),kz.context.globalAlpha=e.text_alpha,kz.context.font="10px font",kz.context.fillStyle="#50605b",kz.context.lineWidth=2,kz.context.fillText("HERMAN CHAU (KCAZE)",kz.canvas.width/2,380),kz.context.restore(),kz.context.fillStyle="rgba(0,0,0,"+e.fadeAlpha+")",kz.context.fillRect(0,0,kz.canvas.width,kz.canvas.height)},t.preUpdate=function(t){for(var a=0;a<kz.events.length;a++)"keypress"!=kz.events[a].kztype||kz.events[a].which!=kz.KEYS.Z||e.exiting||(kz.resources.sounds.sfx_select.play(),e.exiting=!0,e.blink=!1,e.press_space_visible=!1,kz.tween({object:e,property:"fadeAlpha",value:1,duration:100}).then(function(){kz.run(scene_character_select)}));kz.events=[],e.blink&&(e.press_space_visible=2>Math.floor(t/500)%4?!0:!1)},t}(),scene_records=function(){var e,t,a=new kz.Scene;return a.initialize=function(){e={fadeAlpha:1},kz.tween({object:e,property:"fadeAlpha",value:0,duration:100}),t={exiting:!1}},a.draw=function(){kz.context.clearAll(),kz.context.save(),kz.context.fillStyle="#30403b",kz.context.fillRect(0,0,kz.canvas.width,kz.canvas.height),kz.context.restore(),kz.context.textAlign="center",kz.context.textBaseline="center",kz.context.font="48px font",kz.context.fillStyle="rgb(142, 212, 165)",kz.context.fillText("RECORDS",kz.canvas.width/2,125),kz.context.fillStyle="rgba(0,0,0,"+e.fadeAlpha+")",kz.context.fillRect(0,0,kz.canvas.width,kz.canvas.height)},a.preUpdate=function(e){for(e=0;e<kz.events.length;e++)t.exiting||"keypress"!=kz.events[e].kztype||kz.events[e].which!=kz.KEYS.ESCAPE||(t.exiting=!0,kz.tween({object:t,property:"fadeAlpha",value:1,duration:100}).then(function(){kz.run(a)}));kz.events=[]},a}(),character,scene_character_select=function(){var e,t,a=new kz.Scene;return a.initialize=function(){e={selected:0,exiting:!1,fadeAlpha:1},kz.tween({object:e,property:"fadeAlpha",value:0,duration:100}),t=[{description:"ENDS TURN WHITE",name:"BOAR",image:kz.resources.images.character_boar,unlock_message:"13 WHITE ORBS IN A ROW",unlocked:13<=getRecord("max_white_orbs"),zodiac:function(e){for(var t=e.state,a=e.config,n=0;n<a.board_height;n++)t.board[n][0].piece_type&&1!=t.board[n][0].piece_type&&(t.board[n][0].piece_type=1,e.animateColorChange(t.board[n][0].piece,1)),t.board[n][a.board_width-1].piece_type&&1!=t.board[n][a.board_width-1].piece_type&&(t.board[n][a.board_width-1].piece_type=1,e.animateColorChange(t.board[n][a.board_width-1].piece,1))}},{description:"CLEAR ROW ABOVE",name:"CAT",image:kz.resources.images.character_cat,unlocked:!0,zodiac:function(e){var t=e.state,a=e.config,n=e.row;n--;for(var o=[],r=0;r<a.board_width;r++)t.board[n][r].piece&&o.push(t.board[n][r].piece);for(r=0;r<a.board_width;r++)t.board[n][r]={piece_type:0};e.animateClearPieces(o)}},{description:"CLEAR LEFT SIDE",name:"DOG",image:kz.resources.images.character_dog,unlock_message:"169 ORBS SHOT",unlocked:169<=getRecord("total_orbs"),zodiac:function(e){for(var t=e.state.board,a=[],n=0;n<e.config.board_height;n++)t[n][0].piece_type&&(a.push(t[n][0].piece),t[n][0].piece_type=0);e.animateClearPieces(a)}},{description:"CLEAR 4 ON ENDS",name:"DRAGON",image:kz.resources.images.character_dragon,unlock_message:"SCORE 169",unlocked:169<=getRecord("max_score"),zodiac:function(e){for(var t=4,a=4,n=[],o=e.state.board,r=e.config.board_width,i=e.config.board_height-1;i>=0;i--)t&&o[i][0].piece_type&&(n.push(o[i][0].piece),o[i][0].piece_type=0,t--),a&&o[i][r-1].piece_type&&(n.push(o[i][r-1].piece),o[i][r-1].piece_type=0,a--);e.animateClearPieces(n)}},{description:"CLEAR 12 RANDOM",name:"HARE",image:kz.resources.images.character_hare,unlock_message:"REACH LEVEL 13",unlocked:13<=getRecord("max_level"),zodiac:function(e){for(var t=e.state.board,a=0,n=[],o=[],r=0;r<e.config.board_height;r++)for(var i=0;i<e.config.board_width;i++)t[r][i].piece_type&&o.push({x:i,y:r});for(var a=Math.min(o.length,12),c=0;a>c;c++){var s=Math.floor(Math.random()*o.length),i=o[s].x,r=o[s].y;n.push(t[r][i].piece),t[r][i].piece_type=0,n.splice(s,1)}e.animateClearPieces(n)}},{description:"SCORE +2",name:"HORSE",image:kz.resources.images.character_horse,unlock_message:"ZODIAC 13 TIMES",unlocked:13<=getRecord("total_zodiac"),zodiac:function(e){e.incrementScore(2)}},{description:"DELAY ROW DROP",name:"MONKEY",image:kz.resources.images.character_monkey,unlock_message:"ZODIAC 169 TIMES",unlocked:169<=getRecord("total_zodiac"),zodiac:function(e){var t=e.state;t.next_row_time_diff=t.next_row_time-kz.performance.now(),t.next_row_freeze=!0,setTimeout(function(){t.next_row_freeze=!1},5e3)}},{description:"ENDS TURN BLACK",name:"OX",image:kz.resources.images.character_ox,unlock_message:"13 BLACK ORBS IN A ROW",unlocked:13<=getRecord("max_black_orbs"),zodiac:function(e){for(var t=e.state,a=e.config,n=0;n<a.board_height;n++)t.board[n][0].piece_type&&2!=t.board[n][0].piece_type&&(t.board[n][0].piece_type=2,e.animateColorChange(t.board[n][0].piece,2)),t.board[n][a.board_width-1].piece_type&&2!=t.board[n][a.board_width-1].piece_type&&(t.board[n][a.board_width-1].piece_type=2,e.animateColorChange(t.board[n][a.board_width-1].piece,2))}},{description:"NEXT ALL WHITE",name:"RAT",image:kz.resources.images.character_rat,unlock_message:"1313 ORBS SHOT",unlocked:1313<=getRecord("total_orbs"),zodiac:function(e){for(var t=0;8>t;t++)e.state.player.next[t]=1}},{description:"CLEAR RIGHT SIDE",name:"ROOSTER",image:kz.resources.images.character_rooster,unlock_message:"SURVIVE 13 MINUTES",unlocked:780<=getRecord("max_time"),zodiac:function(e){for(var t=e.state.board,a=[],n=e.state.board_width,o=0;o<e.config.board_height;o++)t[o][n-1].piece_type&&(a.push(t[o][n-1].piece),t[o][n-1].piece_type=0);e.animateClearPieces(a)}},{description:"CLEAR TOP ROW",name:"SHEEP",image:kz.resources.images.character_sheep,unlock_message:"SCORE 13",unlocked:13<=getRecord("max_score"),zodiac:function(e){for(var t=e.state,a=e.config,n=[],o=0;o<a.board_width;o++)t.board[0][o].piece&&n.push(t.board[0][o].piece),t.board[0][o]={piece_type:0};e.animateClearPieces(n)}},{description:"NEXT ALL BLACK",name:"SNAKE",image:kz.resources.images.character_snake,unlock_message:"PLAY 13 GAMES",unlocked:13<=getRecord("play_count"),zodiac:function(e){for(var t=0;8>t;t++)e.state.player.next[t]=2}},{description:"SCORE +LEVEL/3",name:"TIGER",image:kz.resources.images.character_tiger,unlock_message:"169 ROWS CLEARED",unlocked:169<=getRecord("total_rows"),zodiac:function(e){e.incrementScore(Math.floor(e.state.level/3))}},{description:"",name:"RANDOM",image:kz.resources.images.character_random,unlocked:!0}]},a.draw=function(a){kz.context.clearAll(),kz.context.save(),kz.context.fillStyle="#30403b",kz.context.fillRect(0,0,kz.canvas.width,kz.canvas.height),kz.context.restore();for(var n=0;7>n;n++)for(var o=0;2>o;o++){var r=2*n+o;if(r>=t.length)break;kz.context.drawImage(t[r].image,49*o+10,49*n+20),t[r].unlocked||(kz.context.fillStyle="rgba(0,0,0,0.7)",kz.context.fillRect(49*o+11,49*n+21,48,48))}Math.floor(a/200)%3&&(kz.context.strokeStyle="#fff",kz.context.lineWidth=1,kz.context.strokeRect(e.selected%2*49+10,49*Math.floor(e.selected/2)+20,50,50)),kz.context.textAlign="right",kz.context.textBaseline="center",kz.context.font="24px font",kz.context.fillStyle="white",kz.context.fillText(t[e.selected].name,kz.canvas.width-10,330),kz.context.textAlign="right",kz.context.textBaseline="center",kz.context.font="16px font",kz.context.fillStyle="white",t[e.selected].unlocked?kz.context.fillText(t[e.selected].description,kz.canvas.width-10,360):(kz.context.font="12px font",kz.context.fillStyle="#50605b",kz.context.fillText(t[e.selected].unlock_message,kz.canvas.width-10,360)),kz.context.fillStyle="rgba(0,0,0,"+e.fadeAlpha+")",kz.context.fillRect(0,0,kz.canvas.width,kz.canvas.height)},a.preUpdate=function(a){for(a=0;a<kz.events.length;a++)if(!e.exiting&&"keypress"==kz.events[a].kztype)if(kz.events[a].which==kz.KEYS.RIGHT)e.selected=Math.min(13,e.selected+1);else if(kz.events[a].which==kz.KEYS.DOWN)e.selected=Math.min(13,e.selected+2);else if(kz.events[a].which==kz.KEYS.LEFT)e.selected=Math.max(0,e.selected-1);else if(kz.events[a].which==kz.KEYS.UP)e.selected=Math.max(0,e.selected-2);else if(kz.events[a].which==kz.KEYS.Z){if(13==e.selected)for(e.selected=Math.floor(14*Math.random());!t[e.selected].unlocked;)e.selected=Math.floor(14*Math.random());t[e.selected].unlocked?(kz.resources.sounds.sfx_select.play(),character=t[e.selected],e.exiting=!0,kz.tween({object:e,property:"fadeAlpha",value:1,duration:100}).then(function(){kz.run(scene_game)})):kz.resources.sounds.sfx_denied.play()}else kz.events[a].which==kz.KEYS.ESCAPE&&(e.exiting=!0,kz.tween({object:e,property:"fadeAlpha",value:1,duration:100}).then(function(){kz.run(scene_main_menu)}));kz.events=[]},a}(),previous_time,scene_game=function(){function e(){kz.tween({object:v,property:"pause_alpha",value:0,duration:50}).then(kz.resume)}function t(){return new Promise(function(e){e()})}function a(e){var t=e.length;return e[Math.floor(Math.random()*t)]}function n(e,a,n){return new kz.Entity({x:e,y:a,type:n,alpha:1,blend_alpha:0,blend_type:0,actions_promise:t()})}function o(e){return[kz.resources.images.piece_red,kz.resources.images.piece_blue,kz.resources.images.piece_zodiac][e-1]}function r(){w.stop(),x.alive=!1,incrementRecord("playcount",1),console.log("Lost :("),S.clearRect(0,0,m.width,m.height),S.drawImage(kz.canvas,0,0),kz.tween({object:v,property:"gameover_background_alpha",value:1,duration:1e3}).then(function(){return kz.tween({object:v,property:"gameover_text_alpha",value:1,duration:1e3})}).then(function(){x.can_restart=!0})}function i(e){kz.resources.sounds.sfx_clear.play();var t=[];e.forEach(function(e){t.push(e.actions_promise)}),t=Promise.all(t),e.forEach(function(e){var a=t.then(function(){return kz.tween({object:e,property:"alpha",value:0,duration:100}).then(function(){e.destroy()})});e.actions_promise=a})}function c(){for(var e=_.board_height-1;e>0;e--)for(var t=0;t<_.board_width;t++)x.board[e][t].piece_type&&!x.board[e-1][t].piece_type&&(x.board[e-1][t]=x.board[e][t],x.board[e][t]={piece_type:A.Empty},function(e){e.actions_promise=e.actions_promise.then(function(){return kz.tween({object:e,property:"y",value:e.y-_.grid_size,duration:100})})}(x.board[e-1][t].piece))}function s(e,t){var a=[1,-1,0,0,1,1,-1,-1],n=[0,0,1,-1,1,-1,1,-1],o=x.board[t][e].piece_type;if(o!=A.Empty&&o!=A.Zodiac)for(var r=0;8>r;r++){for(var i=a[r],c=n[r],s=!1,l=1,h=e+l*i,f=t+l*c;h>=0&&f>=0&&h<_.board_width&&f<_.board_height&&x.board[f][h].piece_type!=A.Empty&&x.board[f][h].piece_type!=A.Zodiac;){if(x.board[f][h].piece_type==o){s=!0;break}l++,h=e+l*i,f=t+l*c}if(s)for(s=1;l>s;s++)h=e+s*i,f=t+s*c,x.board[f][h].piece_type=o,d(x.board[f][h].piece,o)}}function l(e){x.score+=e,maxRecord("max_score",x.score)}function d(e,t){e.actions_promise=e.actions_promise.then(function(){return new Promise(function(a){e.blend_type=t,kz.tween({object:e,property:"blend_alpha",value:1,duration:100}).then(function(){e.type=t,e.blend_type=0,e.blend_alpha=0,a()})})})}function h(){kz.resources.sounds.sfx_drop.play();for(var e=[],t=0;t<_.board_width;t++){var o=a(R);e.push({piece_type:o,piece:n(1+20*t,-19,o)})}for(o=e[_.board_width-1].piece_type,t=0;t<_.board_width;t++)o^=e[t].piece_type;for(o&&(e[_.board_width-1].piece_type^=3,e[_.board_width-1].piece.type^=3),t=0;t<_.board_width;t++){if(x.board[_.board_height-1][t].piece_type!=A.Empty)return void r();for(o=_.board_height-1;o>0;o--)x.board[o][t]=x.board[o-1][t];x.board[0][t]=e[t]}x.board.forEach(function(e){e.forEach(function(e){var t=e.piece;t&&(t.actions_promise=t.actions_promise.then(function(){return kz.tween({object:t,property:"y",value:t.y+_.grid_size,rate:1})}))})})}function f(e){for(e=0;e<kz.events.length;e++)"keypress"==kz.events[e].kztype&&kz.events[e].which==kz.KEYS.Z&&x.can_restart&&kz.tween({object:v,property:"fadeAlpha",value:1,duration:100}).then(function(){kz.run(scene_main_menu)});kz.events=[]}function u(t){for(t=0;t<kz.events.length;t++)"keypress"==kz.events[t].kztype&&(kz.events[t].which==kz.KEYS.ESCAPE?e():kz.events[t].which==kz.KEYS.DOWN?g=Math.min(2,g+1):kz.events[t].which==kz.KEYS.UP?g=Math.max(0,g-1):kz.events[t].which==kz.KEYS.Z&&(e(),0!=g&&kz.tween({object:v,property:"fadeAlpha",value:1,duration:100}).then(1==g?function(){kz.run(T)}:function(){kz.run(scene_main_menu)})));kz.events=[]}var _={board_width:8,board_height:17,grid_size:20,next_length:8,next_row_interval:2e4},p=document.createElement("canvas"),k=document.createElement("canvas"),z=document.createElement("canvas"),m=document.createElement("canvas");p.width=_.board_width*_.grid_size,p.height=390,k.width=96,k.height=390,m.width=280,m.height=390,z.width=280,z.height=390;var x,g,v,w,y=p.getContext("2d"),b=k.getContext("2d"),S=m.getContext("2d"),E=z.getContext("2d"),A={Empty:0,Red:1,Blue:2,Zodiac:3},R=[A.Red,A.Blue],T=new kz.Scene;return T.initialize=function(){w=kz.resources.sounds.bgm_game.play(!0),w.stop(),v={background_pattern:kz.context.createPattern(kz.resources.images.background,"repeat"),pause_alpha:0,gameover_background_alpha:0,gameover_text_alpha:0,fadeAlpha:1},kz.tween({object:v,property:"fadeAlpha",value:0,duration:100}),x={alive:!0,begin:kz.performance.now(),board:[],can_restart:!1,score:0,level:1,rows_cleared:0,next_row_interval:_.next_row_interval,next_row_time:0,next_row_time_diff:0,next_row_freeze:!1,zodiacs:0,consecutive:{1:0,2:0,3:0}},x.next_row_time=kz.performance.now()+x.next_row_interval;for(var e=0;e<_.board_height;e++){x.board.push([]);for(var o=0;o<_.board_width;o++)if(2>e){var i=a(R),c=n(1+20*o,1+20*e,i);if(x.board[e].push({piece_type:i,piece:c}),o==_.board_width-1){for(i=x.board[e][0].piece_type,c=0;c<_.board_width;c++)i&=x.board[e][c].piece_type;i&&(x.board[e][_.board_width-1].piece_type^=3,x.board[e][_.board_width-1].piece.type^=3)}}else x.board[e].push({piece_type:A.Empty})}for(g=0,x.player=new kz.Entity({frames:[kz.resources.images.shooter_0,kz.resources.images.shooter_1,kz.resources.images.shooter_2,kz.resources.images.shooter_3],frame_lengths:[500,200,200,200],current_frame:0,animate_timer:kz.performance.now(),animate:function(e){e-this.animate_timer>this.frame_lengths[this.current_frame]&&(this.current_frame++,this.current_frame%=this.frames.length,this.animate_timer=e)},x:Math.floor(_.board_width/2),sprite_x:4+Math.floor(_.board_width/2)*_.grid_size,sprite_y:_.board_height*_.grid_size+23,actions_promise:t(),draw:function(e){for(e.drawImage(this.frames[this.current_frame],this.sprite_x,this.sprite_y),e=_.board_height-1;e>=0&&x.board[e][this.x].piece_type==A.Empty;e--);y.save(),y.globalAlpha=1,y.lineWidth=1,y.setLineDash([2,8]),y.strokeStyle="#8ed4a5",y.beginPath(),y.moveTo(this.sprite_x+_.grid_size/2-5,this.sprite_y-8),y.lineTo(this.sprite_x+_.grid_size/2-5,(e+1)*_.grid_size+20),y.stroke(),y.restore()},listen:function(e){if("keypress"==e.kztype)switch(e.which){case kz.KEYS.LEFT:this.move(-1);break;case kz.KEYS.RIGHT:this.move(1);break;case kz.KEYS.Z:this.shoot()}else if("keyheld"==e.kztype)switch(e.which){case kz.KEYS.LEFT:this.move(-1);break;case kz.KEYS.RIGHT:this.move(1)}},move:function(e){0<=this.x+e&&this.x+e<_.board_width&&(this.x+=e,this.actions_promise=this.actions_promise.then(function(){return kz.tween({object:this,property:"sprite_x",value:this.sprite_x+e*_.grid_size,rate:.7}).then(function(){return t()}.bind(this))}.bind(this)))},next:[],shoot:function(){if(x.board[_.board_height-1][this.x].piece_type!=A.Empty)r();else{incrementRecord("total_orbs",1);var e=this.next.shift(),t=1<16*Math.random()?a(R):A.Zodiac;this.next.push(t),x.consecutive[e]?(x.consecutive[e]++,console.log("Consecutives: ",x.consecutive)):(x.consecutive[A.Red]=0,x.consecutive[A.Blue]=0,x.consecutive[A.Zodiac]=0,x.consecutive[e]=1),maxRecord({1:"max_white_orbs",2:"max_black_orbs",3:"max_zodiac_orbs"}[e],x.consecutive[e]);for(var o=_.board_height-1;o>0&&x.board[o-1][this.x].piece_type==A.Empty;)o--;var i=n(this.x*_.grid_size+1,(_.board_height-1)*_.grid_size+1,e);x.board[o][this.x]={piece_type:e,piece:i},s(this.x,o),i.actions_promise=i.actions_promise.then(function(){return kz.resources.sounds.sfx_shoot.play(),kz.tween({object:i,property:"y",value:1+20*o,rate:3})})}}}),e=0;8>e;e++)x.player.next.push(a(R)),1>16*Math.random()&&(x.player.next[e]=A.Zodiac)},T.draw=function(e){if(kz.paused)kz.context.clearAll(),kz.context.save(),kz.context.globalAlpha=1,kz.context.drawImage(z,0,0),kz.context.globalAlpha=v.pause_alpha,kz.context.fillStyle="#000000",kz.context.fillRect(0,0,kz.canvas.width,kz.canvas.height),kz.context.restore(),kz.context.save(),kz.context.textAlign="center",kz.context.textBaseline="center",kz.context.font="24px font",kz.context.fillStyle=0==g?"#fff":"#666",kz.context.fillText("RESUME",kz.canvas.width/2,kz.canvas.height/2-48),kz.context.fillStyle=1==g?"#fff":"#666",kz.context.fillText("RESTART",kz.canvas.width/2,kz.canvas.height/2),kz.context.fillStyle=2==g?"#fff":"#666",kz.context.fillText("QUIT",kz.canvas.width/2,kz.canvas.height/2+48),kz.context.restore();else if(x.alive){kz.context.clearAll(),y.clearRect(0,0,p.width,p.height),b.clearRect(0,0,k.width,k.height),y.fillStyle="rgba(0,0,0,0.5)",y.fillRect(0,0,p.width,p.height),y.save(),y.globalAlpha=1,y.lineWidth=1,y.strokeStyle="#50605b",y.beginPath(),y.moveTo(0,_.board_height*_.grid_size+20),y.lineTo(_.board_width*_.grid_size,_.board_height*_.grid_size+20),y.stroke(),y.restore();
for(var t in kz.entities){var a=kz.entities[t];a.type&&(y.globalAlpha=a.alpha,y.drawImage(o(a.type),a.x,a.y+20),a.blend_type&&(y.globalAlpha=a.blend_alpha,y.drawImage(o(a.blend_type),a.x,a.y+20)))}for(y.globalAlpha=1,x.player.draw(y),y.fillStyle="rgba(0, 0, 0, 0.5)",y.fillRect(0,8,p.width,5),y.fillStyle=x.next_row_freeze?"rgb(80, 96, 91)":"rgb(142, 212, 165)",y.fillRect(0,8,p.width*(x.next_row_time-e)/x.next_row_interval,5),b.fillStyle="rgba(0, 0, 0, 0.5)",b.fillRect(0,10,k.width,k.width),b.fillRect(0,117,k.width,80),b.fillRect(0,208,k.width,50),b.fillRect(0,269,k.width,50),b.fillRect(0,330,k.width,50),b.textAlign="center",b.textBaseline="top",b.font="24px font",b.fillStyle="white",b.fillText("NEXT",48,120),b.fillText("SCORE",48,211),b.fillText("LEVEL",48,272),b.fillText("TIME",48,333),b.font="20px font",b.textBaseline="bottom",b.fillText(character.name,48,101),b.font="20px font",b.fillText(""+x.level,48,316),e=""+x.score,e="0".repeat(5-e.length)+e,b.fillText(e,48,255),t=Math.floor((kz.performance.now()-x.begin)/1e3),e=""+t%60,t=""+Math.floor(t/60),time_string="0".repeat(2-t.length)+t+":"+"0".repeat(2-e.length)+e,b.fillText(time_string,48,377),e=0;e<_.next_length;e++)b.drawImage(o(x.player.next[e]),9+e%4*_.grid_size,148+23*Math.floor(e/4));b.drawImage(character.image,23,20),kz.context.fillStyle=v.background_pattern,kz.context.fillRect(0,0,kz.canvas.width,kz.canvas.height),kz.context.drawImage(p,10,0),kz.context.drawImage(k,10+p.width+7,0)}else kz.context.clearAll(),kz.context.save(),kz.context.globalAlpha=1,kz.context.drawImage(m,0,0),kz.context.globalAlpha=v.gameover_background_alpha,kz.context.fillStyle="rgb(142, 212, 165)",kz.context.fillRect(10,kz.canvas.height/2-28,160,42),kz.context.globalAlpha=v.gameover_text_alpha,kz.context.textAlign="center",kz.context.textBaseline="center",kz.context.font="24px font",kz.context.fillStyle="#fff",kz.context.fillText("GAME OVER",kz.canvas.width/2-46,kz.canvas.height/2),kz.context.restore();kz.context.fillStyle="rgba(0,0,0,"+v.fadeAlpha+")",kz.context.fillRect(0,0,kz.canvas.width,kz.canvas.height)},T.preUpdate=function(e){if(kz.paused)u(e);else if(x.alive)e:{maxRecord("max_time",Math.floor(e-x.begin));for(var t=0;t<kz.events.length;t++)if("keypress"==kz.events[t].kztype&&kz.events[t].which==kz.KEYS.ESCAPE){kz.pause(),g=0,E.clearRect(0,0,z.width,z.height),E.drawImage(kz.canvas,0,0),kz.tween({object:v,property:"pause_alpha",value:.8,duration:50}),kz.events=[];break e}kz.processEvents(),x.player.animate(e),x.next_row_freeze&&(x.next_row_time=e+x.next_row_time_diff),x.next_row_time<e&&(h(),x.next_row_time=e+x.next_row_interval);var a;e=!1;for(var n=0;n<_.board_height;n++){for(var o=x.board[n][0].piece_type,r=0,s=!0,t=0;t<_.board_width;t++)if(x.board[n][t].piece_type==A.Zodiac&&r++,o&=x.board[n][t].piece_type,0==o){s=!1;break}if(s){r>0&&(e=!0),a=n;break}}if("undefined"!=typeof a){for(l(1),x.rows_cleared+=1,incrementRecord("total_rows",1),maxRecord("max_rows",x.rows_cleared),0==x.rows_cleared%10&&(x.level+=1,maxRecord("max_level",x.level),x.next_row_interval=Math.max(3e3,x.next_row_interval-750),console.log(x.next_row_interval)),n=[],t=0;t<_.board_width;t++)n.push(x.board[a][t].piece);for(t=0;t<_.board_width;t++)x.board[a][t]={piece_type:A.Empty};i(n),e&&(x.zodiacs++,incrementRecord("total_zodiac",1),maxRecord("total_zodiac",x.zodiacs),character.zodiac({state:x,animateClearPieces:i,animateColorChange:d,config:_,incrementScore:l,row:a}))}c()}else f(e)},T.exit=function(){w.stop()},T}(),audio_context=new AudioContext,resources={images:{background:{data:"images/background.gif"},character_boar:{data:"images/characters.gif",crop:{x:0,y:0,w:50,h:50}},character_cat:{data:"images/characters.gif",crop:{x:49,y:0,w:50,h:50}},character_dog:{data:"images/characters.gif",crop:{x:0,y:49,w:50,h:50}},character_dragon:{data:"images/characters.gif",crop:{x:49,y:49,w:50,h:50}},character_hare:{data:"images/characters.gif",crop:{x:0,y:98,w:50,h:50}},character_horse:{data:"images/characters.gif",crop:{x:49,y:98,w:50,h:50}},character_monkey:{data:"images/characters.gif",crop:{x:0,y:147,w:50,h:50}},character_ox:{data:"images/characters.gif",crop:{x:49,y:147,w:50,h:50}},character_rat:{data:"images/characters.gif",crop:{x:0,y:196,w:50,h:50}},character_rooster:{data:"images/characters.gif",crop:{x:49,y:196,w:50,h:50}},character_sheep:{data:"images/characters.gif",crop:{x:0,y:245,w:50,h:50}},character_snake:{data:"images/characters.gif",crop:{x:49,y:245,w:50,h:50}},character_tiger:{data:"images/characters.gif",crop:{x:0,y:294,w:50,h:50}},character_random:{data:"images/characters.gif",crop:{x:49,y:294,w:50,h:50}},piece_blue:{data:"images/piece_black.gif"},piece_red:{data:"images/piece_white.gif"},piece_zodiac:{data:"images/piece_zodiac.gif"},shooter_0:{data:"images/shooter0.gif"},shooter_1:{data:"images/shooter1.gif"},shooter_2:{data:"images/shooter2.gif"},shooter_3:{data:"images/shooter1.gif"}},sounds:{sfx_shoot:{data:jsfxr([0,,.1881,,.3164,.8042,.2,-.2915,,,,,,.4661,.156,,.1754,-.182,1,,,.1755,,.5]),loader:loadJSFXR},sfx_clear:{data:jsfxr([1,,.06,.4848,.4938,.8917,,,,,,,,,,,,,1,,,,,.49]),loader:loadJSFXR},sfx_select:{data:jsfxr([0,,.0538,.4336,.3186,.4583,,,,,,.5712,.5566,,,,,,1,,,,,.5]),loader:loadJSFXR},sfx_denied:{data:jsfxr([0,,.24,.51,.3829,.15,,,,,,,,,,,,,1,,,,,.5]),loader:loadJSFXR},sfx_drop:{data:jsfxr([1,,.0468,,.2103,.4979,,-.4519,,,,,,,,,,,1,,,,,.83]),loader:loadJSFXR},bgm_game:{loader:loadSonant,data:{endPattern:382,songData:[{osc2_waveform:0,osc2_xenv:0,fx_pan_amt:108,osc2_vol:0,lfo_amt:187,lfo_osc1_freq:0,noise_fader:60,osc1_detune:0,osc2_oct:8,fx_filter:1,fx_resonance:120,fx_pan_freq:5,osc2_det:0,fx_delay_time:4,fx_freq:10332,lfo_waveform:0,osc1_vol:0,fx_delay_amt:16,osc1_waveform:0,notes:[147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0,147,0,0,0],lfo_fx_freq:0,osc2_detune:0,env_release:4607,env_sustain:419,osc1_xenv:0,lfo_freq:5,env_master:130,osc1_det:0,env_attack:50,osc1_oct:8},{osc2_waveform:0,osc2_xenv:0,fx_pan_amt:0,osc2_vol:255,lfo_amt:96,lfo_osc1_freq:0,noise_fader:0,osc1_detune:0,osc2_oct:8,fx_filter:2,fx_resonance:60,fx_pan_freq:0,osc2_det:0,fx_delay_time:1,fx_freq:4067,lfo_waveform:0,osc1_vol:255,fx_delay_amt:45,osc1_waveform:0,notes:[160,0,160,0,155,0,0,0,148,160,162,0,163,162,160,0,163,0,163,162,163,0,151,163,165,0,0,0,167,0,165,0,167,0,163,0,162,0,163,0,156,0,151,162,158,0,0,0,151,0,155,0,151,0,150,0,151,0,150,0,151,0,150,155,160,0,160,0,155,0,148,0,160,0,162,0,160,0,158,160,160,0,158,0,162,160,158,151,146,0,153,0,158,0,153,150,150,0,153,0,151,0,153,0,151,156,158,0,153,0,151,0,158,0,155,0,153,0,151,0,163,0,0,163,0,158,0,151,160,0,160,155,0,160,155,0,0,160,0,162,160,158,160,156,158,0,153,0,150,0,156,0,158,150,143,0,138,0,150,138,150,0,141,0,138,0,150,138,150,0,141,0,0,138,0,150,150,0,148,0,151,0,150,0,148,0,153,160,151,0,0,0,160,0,160,0,156,0,153,0,151,150,0,160,0,156,0,153,153,0,146,0,153,0,158,0,165,0,153,150,153,0,155,0,155,0,153,155,153,0,151,0,153,0,153,0,151,0,153,0,153,0,158,0,160,0,158,0,151,146,151,0,0,0,153,0,163,0,0,0,163,160,163,0,156,0,151,163,170,0,167,163,170,0,160,0,151,163,170,0,167,163,170,0,160,0,0,0,160,0,0,0,170,0,168,0,167,0,0,167,0,170,0,168,168,0,167,0,165,0,167,0,168,0,165,0,0,168,0,165,163,0,163,156,0,0,151,0,0,151,0,156,0,158,0,156,158,0,151,144,156,158,0,151,144,158,0,151,144,156,158,0,158,0,155,0,158,153,151,0,153,165,153,0,148,0,146,0,146,0,153,0,148,0,151,0,155,0,158,0,155,0],lfo_fx_freq:1,osc2_detune:0,env_release:13163,env_sustain:0,osc1_xenv:0,lfo_freq:3,env_master:255,osc1_det:0,env_attack:22,osc1_oct:7},{osc2_waveform:2,osc2_xenv:0,fx_pan_amt:0,osc2_vol:157,lfo_amt:0,lfo_osc1_freq:0,noise_fader:0,osc1_detune:0,osc2_oct:6,fx_filter:2,fx_resonance:76,fx_pan_freq:2,osc2_det:0,fx_delay_time:3,fx_freq:3900,lfo_waveform:0,osc1_vol:192,fx_delay_amt:0,osc1_waveform:2,notes:[160,0,148,0,160,0,148,0,160,172,148,160,172,172,148,0,146,0,170,0,158,158,170,146,158,158,158,146,158,146,0,156,168,156,168,156,0,168,156,156,0,168,0,144,0,144,0,155,0,143,167,167,0,167,155,155,155,167,155,143,0,160,160,148,160,148,172,148,0,160,0,160,172,148,0,148,0,146,0,158,0,158,158,170,170,146,170,170,158,158,158,158,156,0,156,0,144,168,156,168,144,168,156,156,144,156,156,0,155,0,143,155,143,0,155,143,167,155,155,143,167,143,0,160,172,172,160,160,148,172,160,0,148,0,160,0,160,0,158,0,158,0,158,146,0,158,158,158,0,158,0,146,0,168,156,168,168,168,144,156,168,156,168,156,0,144,0,143,155,143,155,143,167,143,155,167,0,155,0,155,0,155,0,148,160,160,0,172,0,148,0,160,160,148,0,160,160,0,146,0,170,0,158,0,146,0,158,0,146,0,146,0,158,0,156,156,156,0,144,0,168,168,144,0,156,168,156,156,144,0,143,155,143,0,143,0,155,0,143,155,167,167,155,0,143,0,151,0,163,0,151,0,151,0,163,0,151,0,151,163,151,0,160,0,148,0,172,160,148,0,160,172,148,160,148,0,160,0,144,168,168,168,144,0,156,156,156,0,156,0,144,168,168,158,0,158,0,146,0,158,0,158,0,158,170,146,158,158,0,151,0,163,175,175,0,163,163,163,151,175,151,0,151,0,160,0,148,0,148,0,160,172,148,0,148,0,160,0,148,0,156,0,144,156,144,168,156,168,144,0,156,0,156,0,144,0,158,170,158,0,158,0,158,0,170,0,158,170],lfo_fx_freq:1,osc2_detune:0,env_release:12631,env_sustain:2418,osc1_xenv:0,lfo_freq:0,env_master:139,osc1_det:0,env_attack:0,osc1_oct:5}],rowLen:1739,songLen:46}}}};window.onload=function(){var e=document.getElementById("fontHack");e.parentNode.removeChild(e),kz.initialize("canvas"),kz.run(scene_loading),kz.loadResources(resources).then(function(){console.log("Loaded resources!"),kz.run(scene_main_menu),setInterval(function(){incrementRecord("total_time",1)},1e3)})},function(){"play_count total_time max_score max_level total_zodiac max_zodiac total_orbs max_white_orbs max_black_orbs max_zodiac_orbs max_rows total_rows max_time".split(" ").forEach(function(e){localStorage.getItem(e)||localStorage.setItem(e,"0")})}();
